# UI 架构文档

本文档详细描述了项目的 UI 架构，包括主题系统、全局样式、通用组件、布局和页面结构。

---

## 1. 设计理念

UI 设计遵循现代化、简洁、一致的原则，旨在提供流畅、直观的用户体验。通过建立一套标准化的主题和通用组件，确保所有页面在外观和交互上保持一致性。采用现代简约/深色科技风格，实现扁平化但立体的视觉效果。

---

## 2. 主题系统重构

主题系统是 UI 架构的核心，已完全重构以支持现代化的设计需求。

### 修正的问题
- **配色问题**: 原有配色方案过于简单，缺乏层次感和现代感
- **主题切换不同步**: 各组件颜色变化不一致，过渡效果不统一
- **颜色变量结构**: 原有颜色变量结构简单，无法满足复杂设计需求

### 新的实现方案
*   **文件路径**: `src/renderer/styles/theme.ts`
*   **重构内容**:
    *   **完整的颜色系统**: 定义了 `lightTheme` 和 `darkTheme` 两个主题对象，包含：
        *   基础颜色: `background`, `foreground`, `surface`, `surfaceVariant`
        *   文本颜色: `textPrimary`, `textSecondary`, `textTertiary`
        *   边框和分割线: `border`, `borderLight`, `divider`
        *   语义化颜色: `primary`, `secondary`, `accent`, `success`, `error`, `warning`, `info`
        *   组件专用颜色: `sidebar`, `titleBar`, `input`, `card`, `button`
        *   动画时长: `transition` 统一配置
    *   **MUI集成**: 同时提供 `muiLightTheme` 和 `muiDarkTheme`，与MUI组件库完美兼容
    *   **嵌套结构**: 采用嵌套的颜色变量结构，便于管理和维护
*   **上下文增强**:
    *   **文件路径**: `src/renderer/contexts/ThemeContext.tsx`
    *   **增强功能**:
        *   **MUI支持**: 集成 `MuiThemeProvider`，提供完整的MUI主题支持
        *   **状态管理**: 新增 `isDarkMode` 状态，便于组件判断当前主题
        *   **HTML属性同步**: 自动更新 `document.documentElement` 的 `data-theme` 属性
        *   **性能优化**: 统一的主题切换逻辑，避免重复渲染

---

## 3. 全局样式优化

全局样式为整个应用提供了一致的基础外观，已针对现代化设计进行优化。

*   **文件路径**: `src/renderer/styles/globalStyles.ts`
*   **优化内容**:
    *   **字体系统**: 使用 `Inter` 作为主要字体，`Fira Code` 作为代码字体
    *   **平滑过渡**: 为 `body` 的背景色和文本颜色添加平滑过渡效果
    *   **焦点样式**: 统一的焦点轮廓样式，符合可访问性要求
    *   **链接样式**: 现代化的链接样式，移除下划线，添加颜色过渡
    *   **盒模型**: 统一的 `box-sizing: border-box` 设置

---

## 4. 通用组件重构

通用组件已完全重构，采用现代化设计，集成动画效果和MUI支持。

### 4.1 Button 组件
*   **文件路径**: `src/renderer/components/common/Button.tsx`
*   **修正的问题**:
    - **样式单一**: 原有按钮样式简单，缺乏现代感
    - **功能有限**: 仅支持基础变体和尺寸
    - **无动画效果**: 缺乏交互反馈
*   **新的实现**:
    - **多种变体**: `primary`, `secondary`, `danger`, `ghost`, `outline` 五种变体
    - **尺寸选项**: `small`, `medium`, `large` 三种尺寸
    - **加载状态**: 内置加载动画和禁用状态
    - **动画效果**: 集成 Framer Motion，提供悬停和点击动画
    - **图标支持**: 支持 `startIcon` 和 `endIcon` 属性
    - **现代设计**: 圆角、阴 ઉ
    - **瞬态 Props**: 使用 `$` 前缀的瞬态 props 来避免将非标准属性传递给 DOM 元素，解决了 React 的警告。

### 4.2 Card 组件 (新增)
*   **文件路径**: `src/renderer/components/common/Card.tsx`
*   **功能特性**:
    - **多种样式**: `elevated`, `outlined`, `filled` 三种变体
    - **灵活配置**: 可调节内边距、圆角大小
    - **交互动画**: 悬停时的阴影变化和位移动画
    - **现代设计**: 柔和阴影、圆角边角、平滑过渡
    - **瞬态 Props**: 使用 `$` 前缀的瞬态 props 来避免将非标准属性传递给 DOM 元素，解决了 React 的警告。

### 4.3 TitleBar 组件重构
*   **文件路径**: `src/renderer/components/common/TitleBar.tsx`
*   **修正的问题**:
    - **Electron默认顶部栏**: 未完全自定义，仍使用系统默认顶部栏
    - **功能简单**: 仅包含基本标题和窗口控制
    - **设计陈旧**: 视觉效果不符合现代设计标准
*   **新的实现**:
    - **完全自定义**: 替换Electron默认顶部栏，支持拖拽功能
    - **现代设计**: 包含应用logo、搜索框、设置按钮和窗口控制
    - **毛玻璃效果**: 使用 `backdrop-filter` 实现现代毛玻璃效果
    - **动画效果**: 集成 Framer Motion，提供流畅的交互动画
    - **图标支持**: 使用 Lucide React 图标库
    - **搜索功能**: 集成搜索输入框，支持全局搜索

### 4.4 其他组件
*   **PageContainer.tsx**: 保持原有功能，适配新主题系统
*   **StatusIndicator.tsx**: 保持原有功能，适配新主题系统

---

## 5. 布局系统重构

布局组件已完全重构，采用现代化设计，集成动画效果和响应式布局。

### 5.1 MainLayout 组件
*   **文件路径**: `src/renderer/layouts/MainLayout.tsx`
*   **修正的问题**:
    - **结构简单**: 原有布局结构简单，缺乏现代感
    - **无动画效果**: 页面切换缺乏过渡动画
*   **新的实现**:
    - **现代结构**: 重新设计布局结构，包含自定义TitleBar
    - **动画效果**: 集成 Framer Motion，提供页面进入动画
    - **自定义滚动条**: 美化的滚动条样式，与主题保持一致
    - **响应式设计**: 使用 Flexbox 实现弹性布局

### 5.2 Sidebar 组件重构
*   **文件路径**: `src/renderer/layouts/Sidebar.tsx`
*   **修正的问题**:
    - **设计陈旧**: 原有侧边栏设计简单，缺乏现代感
    - **功能单一**: 仅提供基础导航功能
    - **无主题切换**: 未集成主题切换功能
*   **新的实现**:
    - **现代设计**: 重新设计侧边栏，包含应用logo、版本信息
    - **分组导航**: 清晰的功能分组和图标导航
    - **主题切换**: 内置主题切换按钮，支持一键切换
    - **动画效果**: 导航项的悬停动画和页面切换动画
    - **图标支持**: 使用 Lucide React 图标库
    - **状态指示**: 当前页面的高亮显示和激活状态

---

## 6. 页面结构重构

页面结构已完全重构，新增首页，所有页面适配新的设计系统。

### 6.1 HomePage 组件 (新增)
*   **文件路径**: `src/renderer/pages/HomePage.tsx`
*   **功能特性**:
    - **欢迎区域**: 渐变标题和应用介绍
    - **统计卡片**: 显示系统状态的动态卡片，包含动画效果
    - **功能介绍**: 四个主要功能的卡片展示，支持悬停动画
    - **快速操作**: 突出的行动按钮，集成动画效果
    - **响应式设计**: 使用 Grid 和 Flexbox 实现响应式布局

### 6.2 其他页面更新
*   **SystemProxyPage.tsx**: 适配新主题系统和组件
*   **MihomoConfigPage.tsx**: 适配新主题系统和组件
*   **DevEnvironmentPage.tsx**: 适配新主题系统和组件
*   **ChatPage.tsx**: 适配新主题系统和组件

### 6.3 App.tsx 更新
*   **文件路径**: `src/renderer/App.tsx`
*   **修正的问题**:
    - **路由配置**: 原有路由配置未包含首页
    - **结构混乱**: 包含不必要的Header和Button组件
*   **新的实现**:
    - **路由更新**: 添加首页路由，配置正确的页面路由
    - **结构简化**: 移除不必要的组件，简化应用结构
    - **主题集成**: 正确集成主题上下文

---

## 7. 技术栈集成

### 7.1 Framer Motion 集成
*   **文件路径**: 多个组件文件
*   **实现内容**:
    - **页面动画**: 所有页面都有流畅的进入动画
    - **交互动画**: 按钮悬停、点击等交互都有微妙的动画反馈
    - **序列动画**: 首页的统计卡片和功能卡片有序列化的展示动画
    - **性能优化**: 使用 transform 和 opacity 进行动画，GPU加速

### 7.2 MUI 集成
*   **文件路径**: `src/renderer/styles/theme.ts`, `src/renderer/contexts/ThemeContext.tsx`
*   **实现内容**:
    - **主题配置**: 完整的 MUI 主题配置，与 styled-components 完美结合
    - **组件支持**: 保留 MUI 组件库的扩展能力
    - **类型支持**: 完整的 TypeScript 类型定义

### 7.3 Lucide React 集成
*   **文件路径**: 多个组件文件
*   **实现内容**:
    - **图标系统**: 统一的图标库，提供一致的视觉体验
    - **图标支持**: 所有组件都支持图标属性
    - **样式统一**: 图标样式与主题系统保持一致

---

## 8. 修正的核心问题总结

### 8.1 视觉设计问题
- **✅ 配色问题**: 建立了现代、统一的配色系统，支持浅色/深色主题
- **✅ 设计陈旧**: 采用现代化设计语言，实现扁平化但立体的视觉效果
- **✅ 缺乏层次感**: 通过阴影、渐变、动画创造丰富的视觉层次

### 8.2 功能性问题
- **✅ Electron默认顶部栏**: 实现了完全自定义的现代化顶部栏
- **✅ 主题切换不同步**: 所有组件颜色变化完全同步，过渡效果统一
- **✅ 无动画效果**: 全面集成 Framer Motion，提供流畅的交互动画

### 8.3 技术架构问题
- **✅ 未使用MUI**: 完整集成了MUI主题系统，提供组件库扩展能力
- **✅ 未集成Framer Motion**: 全面应用了流畅的动画效果和交互反馈
- **✅ 组件系统不完善**: 重构了完整的组件系统，支持现代设计需求

### 8.4 用户体验问题
- **✅ 缺乏首页**: 新增现代化的首页，提供良好的第一印象
- **✅ 交互反馈不足**: 所有交互都有视觉和动画反馈
- **✅ 响应式设计**: 支持不同屏幕尺寸的自适应布局

---

## 9. 设计风格实现

成功实现了"现代简约/深色科技，扁平化又是立体"的设计风格：
- **简约**: 清晰的布局，充足的留白，简洁的视觉元素
- **科技感**: 渐变色彩、毛玻璃效果、现代图标、动画效果
- **扁平化**: 简洁的形状，避免过度装饰，强调功能性
- **立体感**: 通过阴影、层次、动画、渐变创造深度感和空间感

---

## 10. 性能优化

### 10.1 渲染性能
- **CSS变量**: 使用CSS变量实现主题切换，性能优异
- **动画优化**: 使用transform和opacity进行动画，GPU加速
- **组件懒加载**: 支持组件的懒加载和代码分割

### 10.2 用户体验
- **可访问性**: 语义化HTML，键盘导航支持，颜色对比度保证
- **响应式设计**: 弹性布局，自适应不同屏幕尺寸
- **平滑过渡**: 统一的过渡动画时长和缓动函数

新的UI架构完全符合现代桌面应用的设计标准，提供了优秀的用户体验和视觉效果。
